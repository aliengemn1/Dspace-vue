import{r,c as L,o as X,J as Y,w as Z,k as o,m as e,j as Q,t as c,F as w,u as V,B as $,n as I,A as F,x as ee,z as te,l,p as ae}from"./vue-vendor-yx-9Zx-6.js";import{u as se}from"./i18n-CZH2hkgn.js";import{B as le}from"./Breadcrumb-Dz3t5IP6.js";import{P as oe}from"./Pagination-BpceT2iO.js";import{I as ne}from"./ItemCard-DZaC_vic.js";import{i as ue,u as C,b as ce}from"./dspace-CvDgOV_T.js";import{_ as re}from"./index-C9hMAXH0.js";import"./utils-B9ygI19o.js";const ie={class:"browse-view"},de={class:"breadcrumb-section"},ve={class:"container"},he={class:"browse-header"},pe={class:"container"},_e={class:"header-content"},be={class:"page-title"},ye={class:"browse-tabs"},me=["onClick"],ge={width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},fe=["d"],ke={class:"tab-content"},we={class:"tab-label"},Ce={class:"tab-description"},Me={class:"browse-content"},Be={class:"container"},xe={class:"controls-bar"},qe={class:"controls-start"},Ve={class:"results-info"},Ie={key:0,class:"results-count"},Te={key:1,class:"results-count"},je={class:"controls-end"},ze={key:0,class:"sort-wrapper"},Pe=["value"],Re=["value"],Ee={key:0,class:"loading-container"},Se={key:1,class:"entries-grid"},Ne=["onClick"],Le={class:"entry-content"},$e={class:"entry-value"},Fe={key:0,class:"entry-description"},Ae={key:1,class:"entry-description"},De={key:2,class:"entry-description"},He={key:3,class:"entry-description"},Oe={class:"entry-count-wrapper"},Je={class:"entry-count"},Ke={key:0,class:"no-results"},Ue={key:1,class:"results-grid"},Ge={__name:"BrowseView",setup(We){const h=Y(),T=te(),{t:_}=se(),u=r("author"),b=r([]),f=r([]),y=r(!1),m=r(1),p=r(1),d=r(0),g=r(""),i=r("entries"),M=r("count_desc"),A=[{value:"name_asc",label:"الاسم (أ-ي)"},{value:"name_desc",label:"الاسم (ي-أ)"},{value:"count_desc",label:"الأكثر عناصر"},{value:"count_asc",label:"الأقل عناصر"}],j=[{id:"author",label:_("browse.byAuthor"),icon:"users",description:"تصفح حسب المؤلفين"},{id:"subject",label:_("browse.bySubject"),icon:"tag",description:"تصفح حسب الموضوعات"},{id:"dateissued",label:_("browse.byDate"),icon:"calendar",description:"تصفح حسب التاريخ"},{id:"type",label:_("browse.byType"),icon:"layers",description:"تصفح حسب النوع"}],D={users:"M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2 M9 7a4 4 0 100 8 4 4 0 000-8z M23 21v-2a4 4 0 00-3-3.87 M16 3.13a4 4 0 010 7.75",tag:"M20.59 13.41l-7.17 7.17a2 2 0 01-2.83 0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z M7 7h.01",calendar:"M19 4H5a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2V6a2 2 0 00-2-2z M16 2v4 M8 2v4 M3 10h18",layers:"M12 2L2 7l10 5 10-5-10-5z M2 17l10 5 10-5 M2 12l10 5 10-5"},H=L(()=>j.find(t=>t.id===u.value)||j[0]),O=L(()=>[{label:_("nav.home"),path:"/"},{label:_("nav.browse"),path:"/browse"}]),J={author:[{value:"محمد عبدالله الشمري",count:15},{value:"فاطمة أحمد العتيبي",count:12},{value:"خالد سعد القحطاني",count:10},{value:"نورة محمد الدوسري",count:8},{value:"عبدالرحمن علي المالكي",count:7},{value:"سارة عبدالعزيز الحربي",count:6},{value:"أحمد محمد الغامدي",count:5},{value:"منال سعود العنزي",count:5},{value:"عبدالله خالد الزهراني",count:4},{value:"ريم سالم الحربي",count:4},{value:"ماجد عبدالعزيز النفيسة",count:3},{value:"هند محمد الشريف",count:3}],subject:[{value:"المكتبات والمعلومات",count:45},{value:"التحول الرقمي",count:38},{value:"المخطوطات الإسلامية",count:32},{value:"إدارة المعرفة",count:28},{value:"التراث الثقافي",count:25},{value:"الفهرسة والتصنيف",count:22},{value:"البحث العلمي",count:20},{value:"الأرشفة الإلكترونية",count:18},{value:"الذكاء الاصطناعي",count:15},{value:"قواعد البيانات",count:12}],dateissued:[{value:"2024",count:125},{value:"2023",count:340},{value:"2022",count:280},{value:"2021",count:195},{value:"2020",count:165},{value:"2019",count:142},{value:"2018",count:128},{value:"2017",count:98}],type:[{value:"رسالة ماجستير",count:35e3},{value:"رسالة دكتوراه",count:25e3},{value:"بحث علمي",count:15e3},{value:"كتاب",count:8e3},{value:"مقال",count:5e3},{value:"تقرير",count:2e3}]},B=[{id:1,title:"دراسة تحليلية لأثر التحول الرقمي على الخدمات المكتبية",author:"محمد عبدالله الشمري",date:"2024",type:"رسالة ماجستير",collection:"رسائل علمية",thumbnail:null},{id:2,title:"المخطوطات العربية في مكتبة الملك فهد الوطنية",author:"فاطمة أحمد العتيبي",date:"2024",type:"بحث علمي",collection:"أبحاث",thumbnail:null},{id:3,title:"تطوير نظم المعلومات في المكتبات الأكاديمية",author:"خالد سعد القحطاني",date:"2023",type:"رسالة دكتوراه",collection:"رسائل علمية",thumbnail:null}];async function k(){var t,s,a;y.value=!0,i.value="entries";try{const n=await ce.byIndex(u.value,{page:m.value-1,size:20});b.value=((t=n._embedded)==null?void 0:t.entries)||[],p.value=((s=n.page)==null?void 0:s.totalPages)||1,d.value=((a=n.page)==null?void 0:a.totalElements)||0}catch{b.value=J[u.value]||[],p.value=1,d.value=b.value.length}finally{y.value=!1,P({target:{value:M.value}})}}async function x(t){var s,a,n,R,E,S;y.value=!0,i.value="results",g.value=t;try{const q=await ue.search(t,{page:m.value-1,size:12});(n=(a=(s=q._embedded)==null?void 0:s.searchResult)==null?void 0:a._embedded)!=null&&n.objects?(f.value=q._embedded.searchResult._embedded.objects.map(v=>{var N;return(N=v._embedded)==null?void 0:N.indexableObject}).filter(Boolean).map(v=>({id:v.uuid,title:C.getMetadataValue(v.metadata,"dc.title")||"بدون عنوان",author:C.getMetadataValue(v.metadata,"dc.contributor.author")||"غير معروف",date:C.getMetadataValue(v.metadata,"dc.date.issued")||"",type:C.getMetadataValue(v.metadata,"dc.type")||"",collection:"",thumbnail:C.getThumbnailUrl(v)})),d.value=((S=(E=(R=q._embedded)==null?void 0:R.searchResult)==null?void 0:E.page)==null?void 0:S.totalElements)||0,p.value=Math.ceil(d.value/12)):(f.value=B,d.value=B.length,p.value=1)}catch{f.value=B,d.value=B.length,p.value=1}finally{y.value=!1}}function K(t){u.value=t,m.value=1,i.value="entries",g.value="",T.push({query:{type:t}}),k()}function U(t){m.value=t,i.value==="entries"?k():x(g.value)}function G(t){x(t.value),T.push({query:{type:u.value,filter:t.value}})}function z(){i.value="entries",g.value="",m.value=1,T.push({query:{type:u.value}}),k()}function W(t){return t>=1e3?(t/1e3).toFixed(1)+"K":t.toString()}function P(t){M.value=t.target.value;const s=[...b.value];switch(M.value){case"name_asc":s.sort((a,n)=>a.value.localeCompare(n.value,"ar"));break;case"name_desc":s.sort((a,n)=>n.value.localeCompare(a.value,"ar"));break;case"count_desc":s.sort((a,n)=>n.count-a.count);break;case"count_asc":s.sort((a,n)=>a.count-n.count);break}b.value=s}return X(()=>{h.query.type&&(u.value=h.query.type),h.query.filter||h.query.q?x(h.query.filter||h.query.q):k()}),Z(()=>h.query,t=>{t.type&&t.type!==u.value&&(u.value=t.type,t.filter||t.q?x(t.filter||t.q):k())}),(t,s)=>(l(),o("div",ie,[e("div",de,[e("div",ve,[Q(le,{items:O.value},null,8,["items"])])]),e("div",he,[e("div",pe,[e("div",_e,[e("h1",be,c(t.$t("browse.title")),1),s[0]||(s[0]=e("p",{class:"page-description"},"استكشف محتويات المستودع الرقمي",-1))]),e("div",ye,[(l(),o(w,null,V(j,a=>e("button",{key:a.id,class:ae(["browse-tab",{active:u.value===a.id}]),onClick:n=>K(a.id)},[(l(),o("svg",ge,[e("path",{d:D[a.icon]},null,8,fe)])),e("div",ke,[e("span",we,c(a.label),1),e("span",Ce,c(a.description),1)])],10,me)),64))])])]),e("div",Me,[e("div",Be,[e("div",xe,[e("div",qe,[i.value==="results"?(l(),o("button",{key:0,class:"btn btn-secondary",onClick:z},[...s[1]||(s[1]=[e("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"15 18 9 12 15 6"})],-1),F(" العودة للقائمة ",-1)])])):I("",!0),e("div",Ve,[i.value==="entries"?(l(),o("span",Ie,c(d.value)+" "+c(H.value.label),1)):(l(),o("span",Te,[e("strong",null,c(g.value),1),F(" - "+c(d.value)+" نتيجة ",1)]))])]),e("div",je,[i.value==="entries"?(l(),o("div",ze,[s[2]||(s[2]=e("label",{for:"sort-select"},"ترتيب:",-1)),e("select",{id:"sort-select",class:"sort-select",value:M.value,onChange:P},[(l(),o(w,null,V(A,a=>e("option",{key:a.value,value:a.value},c(a.label),9,Re)),64))],40,Pe)])):I("",!0)])]),y.value?(l(),o("div",Ee,[s[3]||(s[3]=e("div",{class:"spinner"},null,-1)),e("p",null,c(t.$t("common.loading")),1)])):i.value==="entries"?(l(),o("div",Se,[(l(!0),o(w,null,V(b.value,a=>(l(),o("button",{key:a.value,class:"entry-card",onClick:n=>G(a)},[e("div",Le,[e("span",$e,c(a.value),1),u.value==="author"?(l(),o("span",Fe,"مؤلف")):u.value==="subject"?(l(),o("span",Ae,"موضوع")):u.value==="dateissued"?(l(),o("span",De,"سنة النشر")):u.value==="type"?(l(),o("span",He,"نوع المحتوى")):I("",!0)]),e("div",Oe,[e("span",Je,c(W(a.count)),1),s[4]||(s[4]=e("span",{class:"count-label"},"عنصر",-1))]),s[5]||(s[5]=e("div",{class:"entry-arrow"},[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"9 18 15 12 9 6"})])],-1))],8,Ne))),128))])):(l(),o(w,{key:2},[f.value.length===0?(l(),o("div",Ke,[s[6]||(s[6]=ee('<div class="no-results-icon" data-v-85ac74ee><svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" data-v-85ac74ee><circle cx="11" cy="11" r="8" data-v-85ac74ee></circle><line x1="21" y1="21" x2="16.65" y2="16.65" data-v-85ac74ee></line><line x1="8" y1="11" x2="14" y2="11" data-v-85ac74ee></line></svg></div><h3 data-v-85ac74ee>لا توجد نتائج</h3>',2)),e("p",null,'لم يتم العثور على عناصر مطابقة لـ "'+c(g.value)+'"',1),e("button",{class:"btn btn-primary",onClick:z},"العودة للتصفح")])):(l(),o("div",Ue,[(l(!0),o(w,null,V(f.value,a=>(l(),$(ne,{key:a.id,item:a},null,8,["item"]))),128))]))],64)),p.value>1&&!y.value?(l(),$(oe,{key:3,"current-page":m.value,"total-pages":p.value,onPageChange:U},null,8,["current-page","total-pages"])):I("",!0)])])]))}},lt=re(Ge,[["__scopeId","data-v-85ac74ee"]]);export{lt as default};
