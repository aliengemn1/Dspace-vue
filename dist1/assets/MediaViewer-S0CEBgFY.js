import{u as O}from"./i18n-CZH2hkgn.js";import{P as j,I as q,V as z}from"./ImageSlider-D-pIzYi2.js";import{e as E}from"./dspace-CvDgOV_T.js";import{_ as L}from"./index-C9hMAXH0.js";import{c as v,r as G,w as J,o as K,k as s,l as n,n as g,m as t,F as k,u as B,p as Q,t as m,B as M,O as $,x as R,A as X}from"./vue-vendor-yx-9Zx-6.js";const Y={class:"media-viewer"},Z={key:0,class:"media-tabs"},_=["onClick"],ee={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},le={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},te={key:2,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ie={key:3,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ne={class:"media-content"},se={key:0,class:"file-selector"},ae=["value","selected"],oe={key:0,class:"file-selector"},de=["value","selected"],ue={key:3,class:"audio-player-container"},re={key:0,class:"file-selector"},ce=["value","selected"],ve={class:"audio-wrapper"},me={class:"audio-filename"},he=["src"],fe={key:4,class:"no-preview"},ge={__name:"MediaViewer",props:{files:{type:Array,required:!0},selectedFile:{type:Object,default:null}},emits:["close","download","select-file"],setup(a,{emit:A}){const{t:b}=O(),o=a,D=A,w=e=>e==null?void 0:e.startsWith("image/"),F=e=>e==null?void 0:e.startsWith("video/"),y=e=>e==="application/pdf",V=e=>e==null?void 0:e.startsWith("audio/"),r=v(()=>o.files.filter(e=>y(e.mimeType))),h=v(()=>o.files.filter(e=>w(e.mimeType))),u=v(()=>o.files.filter(e=>F(e.mimeType))),c=v(()=>o.files.filter(e=>V(e.mimeType)));v(()=>o.files.filter(e=>!y(e.mimeType)&&!w(e.mimeType)&&!F(e.mimeType)&&!V(e.mimeType))),v(()=>{if(!o.selectedFile)return r.value.length>0?"pdf":h.value.length>0?"image":u.value.length>0?"video":c.value.length>0?"audio":"none";const e=o.selectedFile.mimeType;return y(e)?"pdf":w(e)?"image":F(e)?"video":V(e)?"audio":"other"});const x=e=>e?E.getContentUrl(e.id):null,I=v(()=>x(o.selectedFile)),H=v(()=>h.value.map(e=>({src:x(e),name:e.name,alt:e.name})));v(()=>!o.selectedFile||!w(o.selectedFile.mimeType)?0:h.value.findIndex(e=>e.id===o.selectedFile.id));const P=v(()=>{const e=[];return r.value.length>0&&e.push({type:"pdf",label:`PDF (${r.value.length})`,icon:"pdf"}),h.value.length>0&&e.push({type:"image",label:`صور (${h.value.length})`,icon:"image"}),u.value.length>0&&e.push({type:"video",label:`فيديو (${u.value.length})`,icon:"video"}),c.value.length>0&&e.push({type:"audio",label:`صوت (${c.value.length})`,icon:"audio"}),e}),d=G("pdf");J(()=>o.files,e=>{e&&e.length>0&&(e.some(l=>y(l.mimeType))?d.value="pdf":e.some(l=>w(l.mimeType))?d.value="image":e.some(l=>F(l.mimeType))?d.value="video":e.some(l=>V(l.mimeType))&&(d.value="audio"))},{immediate:!0}),K(()=>{r.value.length>0?d.value="pdf":h.value.length>0?d.value="image":u.value.length>0?d.value="video":c.value.length>0&&(d.value="audio")});function U(e){d.value=e;let l=null;switch(e){case"pdf":l=r.value[0];break;case"image":l=h.value[0];break;case"video":l=u.value[0];break;case"audio":l=c.value[0];break}l&&D("select-file",l)}function T(){D("close")}function C(e){D("download",e||o.selectedFile)}function W(){C(o.selectedFile)}return(e,l)=>{var N,S;return n(),s("div",Y,[P.value.length>1?(n(),s("div",Z,[(n(!0),s(k,null,B(P.value,i=>(n(),s("button",{key:i.type,class:Q(["media-tab",{"is-active":d.value===i.type}]),onClick:p=>U(i.type)},[i.icon==="pdf"?(n(),s("svg",ee,[...l[4]||(l[4]=[t("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"},null,-1),t("polyline",{points:"14 2 14 8 20 8"},null,-1)])])):i.icon==="image"?(n(),s("svg",le,[...l[5]||(l[5]=[t("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"},null,-1),t("circle",{cx:"8.5",cy:"8.5",r:"1.5"},null,-1),t("polyline",{points:"21 15 16 10 5 21"},null,-1)])])):i.icon==="video"?(n(),s("svg",te,[...l[6]||(l[6]=[t("polygon",{points:"23 7 16 12 23 17 23 7"},null,-1),t("rect",{x:"1",y:"5",width:"15",height:"14",rx:"2",ry:"2"},null,-1)])])):i.icon==="audio"?(n(),s("svg",ie,[...l[7]||(l[7]=[t("path",{d:"M9 18V5l12-2v13"},null,-1),t("circle",{cx:"6",cy:"18",r:"3"},null,-1),t("circle",{cx:"18",cy:"16",r:"3"},null,-1)])])):g("",!0),t("span",null,m(i.label),1)],10,_))),128))])):g("",!0),t("div",ne,[d.value==="pdf"&&r.value.length>0?(n(),s(k,{key:0},[r.value.length>1?(n(),s("div",se,[t("label",null,m($(b)("item.selectFile")||"اختر الملف")+":",1),t("select",{onChange:l[0]||(l[0]=i=>e.$emit("select-file",r.value[i.target.value]))},[(n(!0),s(k,null,B(r.value,(i,p)=>{var f;return n(),s("option",{key:i.id,value:p,selected:((f=a.selectedFile)==null?void 0:f.id)===i.id},m(i.name),9,ae)}),128))],32)])):g("",!0),a.selectedFile&&y(a.selectedFile.mimeType)||r.value.length>0?(n(),M(j,{key:1,src:a.selectedFile&&y(a.selectedFile.mimeType)?I.value:x(r.value[0]),"file-name":a.selectedFile&&y(a.selectedFile.mimeType)?a.selectedFile.name:r.value[0].name,onClose:T,onDownload:W},null,8,["src","file-name"])):g("",!0)],64)):d.value==="image"&&h.value.length>0?(n(),M(q,{key:1,images:H.value,onClose:T,onDownload:C},null,8,["images"])):d.value==="video"&&u.value.length>0?(n(),s(k,{key:2},[u.value.length>1?(n(),s("div",oe,[t("label",null,m($(b)("item.selectFile")||"اختر الملف")+":",1),t("select",{onChange:l[1]||(l[1]=i=>e.$emit("select-file",u.value[i.target.value]))},[(n(!0),s(k,null,B(u.value,(i,p)=>{var f;return n(),s("option",{key:i.id,value:p,selected:((f=a.selectedFile)==null?void 0:f.id)===i.id},m(i.name),9,de)}),128))],32)])):g("",!0),a.selectedFile&&F(a.selectedFile.mimeType)?(n(),M(z,{key:1,src:I.value,title:a.selectedFile.name,"mime-type":a.selectedFile.mimeType,onClose:T,onDownload:C},null,8,["src","title","mime-type"])):u.value.length>0?(n(),M(z,{key:2,src:x(u.value[0]),title:u.value[0].name,"mime-type":u.value[0].mimeType,onClose:T,onDownload:C},null,8,["src","title","mime-type"])):g("",!0)],64)):d.value==="audio"&&c.value.length>0?(n(),s("div",ue,[c.value.length>1?(n(),s("div",re,[t("label",null,m($(b)("item.selectFile")||"اختر الملف")+":",1),t("select",{onChange:l[2]||(l[2]=i=>e.$emit("select-file",c.value[i.target.value]))},[(n(!0),s(k,null,B(c.value,(i,p)=>{var f;return n(),s("option",{key:i.id,value:p,selected:((f=a.selectedFile)==null?void 0:f.id)===i.id},m(i.name),9,ce)}),128))],32)])):g("",!0),t("div",ve,[l[8]||(l[8]=R('<div class="audio-icon" data-v-49988516><svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" data-v-49988516><path d="M9 18V5l12-2v13" data-v-49988516></path><circle cx="6" cy="18" r="3" data-v-49988516></circle><circle cx="18" cy="16" r="3" data-v-49988516></circle></svg></div>',1)),t("p",me,m(((N=a.selectedFile)==null?void 0:N.name)||((S=c.value[0])==null?void 0:S.name)),1),t("audio",{controls:"",src:a.selectedFile?I.value:x(c.value[0]),class:"audio-element"},null,8,he)])])):(n(),s("div",fe,[l[10]||(l[10]=t("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[t("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),t("polyline",{points:"14 2 14 8 20 8"})],-1)),l[11]||(l[11]=t("p",null,"لا تتوفر معاينة لهذا الملف",-1)),a.selectedFile?(n(),s("button",{key:0,class:"btn btn-primary",onClick:l[3]||(l[3]=i=>C())},[l[9]||(l[9]=t("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),t("polyline",{points:"7 10 12 15 17 10"}),t("line",{x1:"12",y1:"15",x2:"12",y2:"3"})],-1)),X(" "+m($(b)("item.download")),1)])):g("",!0)]))])])}}},xe=L(ge,[["__scopeId","data-v-49988516"]]);export{xe as M};
